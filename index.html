<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ONU ADD SCRIPT</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Montserrat:wght@400;500;600;700&family=Roboto+Mono:wght@400;500&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background: 
                linear-gradient(135deg, 
                    rgba(210, 106, 241, 0.95) 0%, 
                    rgba(186, 104, 200, 0.9) 25%, 
                    rgba(156, 39, 176, 0.85) 50%, 
                    rgba(142, 36, 170, 0.9) 75%, 
                    rgba(123, 31, 162, 0.95) 100%),
                radial-gradient(circle at 20% 80%, 
                    rgba(186, 104, 200, 0.4) 0%, 
                    transparent 60%),
                radial-gradient(circle at 80% 20%, 
                    rgba(156, 39, 176, 0.4) 0%, 
                    transparent 60%);
            background-color: #40B5AD;
            background-blend-mode: overlay, normal, normal;
            color: #40E0D0;
            margin: 0;
            padding: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            transition: background 0.5s ease, color 0.3s;
        }
        
        body.dark-mode {
            background: 
                linear-gradient(135deg, 
                    rgba(74, 20, 140, 0.95) 0%, 
                    rgba(81, 45, 168, 0.9) 25%, 
                    rgba(94, 53, 177, 0.85) 50%, 
                    rgba(103, 58, 183, 0.9) 75%, 
                    rgba(123, 31, 162, 0.95) 100%),
                radial-gradient(circle at 20% 80%, 
                    rgba(142, 36, 170, 0.4) 0%, 
                    transparent 60%),
                radial-gradient(circle at 80% 20%, 
                    rgba(156, 39, 176, 0.4) 0%, 
                    transparent 60%);
            background-color: #7B1FA2;
            background-blend-mode: overlay, normal, normal;
            color: #f3e5f5;
        }

        h1 {
    font-family: 'Dancing Script', cursive;
    font-size: 1.6rem; /* Reduced from 1.8rem */
    font-weight: 900;
    text-align: center;
    margin: 8px 0 4px 0; /* Reduced margin */
    background: #6026AB;
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.prepared-by {
    text-align: center;
    font-weight: 600;
    font-size: 0.75rem; /* Reduced from 0.8rem */
    color: #470047;
    margin-bottom: 12px; /* Reduced from 15px */
    font-family: 'Montserrat', sans-serif;
    letter-spacing: 0.5px;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

.theme-toggle {
    position: absolute;
    top: 12px; /* Reduced from 15px */
    right: 12px; /* Reduced from 15px */
    z-index: 10;
}

.theme-toggle button {
    background: rgba(255, 255, 255, 0.9);
    color: #9c27b0;
    border: 1px solid rgba(156, 39, 176, 0.3);
    cursor: pointer;
    padding: 6px 8px; /* Reduced from 8px 10px */
    border-radius: 50%;
    font-size: 0.8rem; /* Reduced from 0.9rem */
    outline: none;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.main-container {
    display: flex;
    flex-direction: row;
    gap: 15px; /* Reduced from 20px */
    width: 100%;
    max-width: 950px; /* Reduced from 1000px */
    justify-content: center;
    padding: 15px; /* Reduced from 20px */
    background: rgba(255, 255, 255, 0.92);
    border-radius: 10px; /* Reduced from 12px */
    box-shadow: 
        0 8px 25px rgba(156, 39, 176, 0.3), /* Reduced shadow */
        0 3px 10px rgba(142, 36, 170, 0.25);
    transition: all 0.3s ease;
    position: relative;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(186, 104, 200, 0.3);
}

.panel {
    flex: 1;
    background: rgba(255, 255, 255, 0.95);
    padding: 15px; /* Reduced from 20px */
    border-radius: 8px; /* Reduced from 10px */
    box-shadow: 
        0 4px 15px rgba(156, 39, 176, 0.2), /* Reduced shadow */
        inset 0 1px 0 rgba(255, 255, 255, 0.8);
    display: flex;
    flex-direction: column;
    transition: all 0.3s ease;
    border: 1px solid rgba(186, 104, 200, 0.2);
}

.panel-header {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px; /* Reduced from 10px */
    margin-bottom: 15px; /* Reduced from 18px */
    color: #9c27b0;
    font-size: 0.95rem; /* Reduced from 1.0rem */
    font-weight: 700;
    padding-bottom: 8px; /* Reduced from 10px */
    border-bottom: 1px solid #ba68c8; /* Reduced from 2px */
    transition: color 0.3s, border-bottom 0.3s;
    font-family: 'Montserrat', sans-serif;
}

.input-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 8px; /* Reduced from 10px */
}

.input-grid.two-col {
    grid-template-columns: repeat(2, 1fr);
}

.input-grid.vlan-grid {
    grid-template-columns: repeat(4, 1fr);
    gap: 5px; /* Reduced from 6px */
}

.input-group label {
    font-weight: 600;
    font-size: 0.8rem; /* Reduced from 0.85rem */
    margin-bottom: 4px; /* Reduced from 5px */
    color: #7b1fa2;
    transition: color 0.3s;
    font-family: 'Montserrat', sans-serif;
}

.input-group input, .input-group select {
    width: 100%;
    padding: 8px 10px; /* Reduced from 10px 12px */
    border: 1px solid #e1bee7;
    border-radius: 5px; /* Reduced from 6px */
    font-size: 0.8rem; /* Reduced from 0.85rem */
    box-sizing: border-box;
    background: rgba(243, 229, 245, 0.9);
    font-family: 'Roboto', sans-serif;
    transition: all 0.3s ease;
    color: #4a148c;
    box-shadow: 
        inset 0 1px 2px rgba(0, 0, 0, 0.05);
}

/* Style gaps between sections */
.input-grid[style*="margin-top"] {
    margin-top: 10px !important; /* Reduced from 12px */
}

        .button-group {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-top: 20px;
        }
        
        .button-group button {
            padding: 12px 20px;
            border: none;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-family: 'Montserrat', sans-serif;
            letter-spacing: 0.5px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
            min-width: 120px;
            position: relative;
            overflow: hidden;
        }
        
        .button-group button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.3), 
                transparent);
            transition: left 0.6s;
        }
        
        .button-group button:hover::before {
            left: 100%;
        }
        
        #generate-btn {
            background: linear-gradient(135deg, #9c27b0 0%, #7b1fa2 100%);
            color: white;
        }
        
        #generate-btn:hover {
            background: linear-gradient(135deg, #ba68c8 0%, #9c27b0 100%);
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(156, 39, 176, 0.4);
        }
        
        #clear-btn {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
            color: white;
        }
        
        #clear-btn:hover {
            background: linear-gradient(135deg, #ef5350 0%, #f44336 100%);
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(244, 67, 54, 0.4);
        }
        
        body.dark-mode #generate-btn {
            background: linear-gradient(135deg, #7b1fa2 0%, #6a1b9a 100%);
        }
        
        body.dark-mode #generate-btn:hover {
            background: linear-gradient(135deg, #9c27b0 0%, #8e24aa 100%);
        }
        
        body.dark-mode #clear-btn {
            background: linear-gradient(135deg, #d32f2f 0%, #c62828 100%);
        }
        
        body.dark-mode #clear-btn:hover {
            background: linear-gradient(135deg, #f44336 0%, #e53935 100%);
        }

        .output-panel {
            position: relative;
            margin-top: 0;
        }

        #output-script {
            background: rgba(243, 229, 245, 0.9);
            color: #4a148c;
            padding: 18px;
            border-radius: 6px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
            min-height: 220px;
            font-size: 0.85rem;
            line-height: 1.4;
            border: 1px solid #e1bee7;
            font-family: 'Roboto Mono', monospace;
            font-weight: 500;
            transition: all 0.3s ease;
            max-height: 350px;
            overflow-y: auto;
            box-shadow: 
                inset 0 1px 2px rgba(0, 0, 0, 0.05);
        }
        
        body.dark-mode #output-script {
            background: rgba(243, 229, 245, 0.15);
            color: #f3e5f5;
            border: 1px solid rgba(206, 147, 216, 0.3);
        }

        .output-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 15px;
        }
        
        #copy-btn {
            background: linear-gradient(135deg, #673ab7 0%, #5e35b1 100%);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-family: 'Montserrat', sans-serif;
            letter-spacing: 0.5px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
            min-width: 100px;
            position: relative;
            overflow: hidden;
        }
        
        #copy-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.3), 
                transparent);
            transition: left 0.6s;
        }
        
        #copy-btn:hover::before {
            left: 100%;
        }
        
        #copy-btn:hover {
            background: linear-gradient(135deg, #7e57c2 0%, #673ab7 100%);
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(103, 58, 183, 0.4);
        }
        
        body.dark-mode #copy-btn {
            background: linear-gradient(135deg, #5e35b1 0%, #512da8 100%);
        }
        
        body.dark-mode #copy-btn:hover {
            background: linear-gradient(135deg, #7e57c2 0%, #673ab7 100%);
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            .main-container {
                flex-direction: column;
                max-width: 95%;
                padding: 18px;
            }
            
            .panel {
                padding: 18px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .prepared-by {
                font-size: 1.0rem;
            }
        }

        @media (max-width: 768px) {
            .input-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .input-grid.vlan-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .button-group {
                flex-direction: column;
                align-items: center;
            }
            
            .button-group button {
                width: 100%;
                max-width: 250px;
            }
            
            h1 {
                font-size: 1.8rem;
                margin-top: 40px;
            }
            
            .theme-toggle {
                top: 12px;
                right: 12px;
            }
            
            .main-container {
                padding: 15px;
            }
        }

        @media (max-width: 576px) {
            .input-grid {
                grid-template-columns: 1fr;
            }
            
            .input-grid.two-col {
                grid-template-columns: 1fr;
            }
            
            .input-grid.vlan-grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 1.6rem;
            }
            
            .prepared-by {
                font-size: 0.95rem;
            }
            
            .panel-header {
                font-size: 1.1rem;
            }
            
            .button-group button {
                padding: 10px 18px;
            }
        }

        /* Scrollbar styling */
        #output-script::-webkit-scrollbar {
            width: 6px;
        }
        
        #output-script::-webkit-scrollbar-track {
            background: rgba(225, 190, 231, 0.3);
            border-radius: 4px;
        }
        
        #output-script::-webkit-scrollbar-thumb {
            background: #ba68c8;
            border-radius: 4px;
        }
        
        #output-script::-webkit-scrollbar-thumb:hover {
            background: #9c27b0;
        }
        
        body.dark-mode #output-script::-webkit-scrollbar-track {
            background: rgba(206, 147, 216, 0.2);
        }
        
        body.dark-mode #output-script::-webkit-scrollbar-thumb {
            background: #ba68c8;
        }
        
        body.dark-mode #output-script::-webkit-scrollbar-thumb:hover {
            background: #ce93d8;
        }

        /* Animation for panel entrance */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .panel {
            animation: fadeInUp 0.5s ease-out;
        }
        
        .output-panel {
            animation: fadeInUp 0.5s ease-out 0.2s both;
        }
        
        /* Smaller icon sizes */
        .material-icons {
            font-size: 1.1rem;
        }
        
        /* Number input spinner styling */
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            opacity: 0.6;
            background: rgba(156, 39, 176, 0.3);
            border-radius: 2px;
        }
        
        /* Selection color */
        ::selection {
            background-color: rgba(156, 39, 176, 0.4);
            color: white;
        }
        
        ::-moz-selection {
            background-color: rgba(156, 39, 176, 0.4);
            color: white;
        }
        
        body.dark-mode ::selection {
            background-color: rgba(186, 104, 200, 0.4);
            color: white;
        }
        
        body.dark-mode ::-moz-selection {
            background-color: rgba(186, 104, 200, 0.4);
            color: white;
        }
    </style>
</head>
<body>

<h1>ONU ADD SCRIPT</h1>

<div class="prepared-by">
    Prepared by AHSANUL KABIR
</div>

<div class="main-container">
    <div class="theme-toggle">
        <button onclick="toggleDarkMode()">
            <span class="material-icons">brightness_4</span>
        </button>
    </div>

    <div class="panel">
        <div class="panel-header">
            <span class="material-icons">settings_input_component</span> Configuration Inputs
        </div>

        <div class="input-grid two-col">
            <div class="input-group">
                <label for="olt-type">OLT Type</label>
                <select id="olt-type">
                    <option value="vsol-gpon">VSOL GPON</option>
                    <option value="cdata-gpon-16">CData GPON 16-PON</option>
                    <option value="cdata-gpon-8">CData GPON 8-PON</option>
                    <option value="utstarcom">UTStarcom</option>
                    <option value="fh-net">FH-NET</option>
                    <option value="phyhome">Phyhome</option>
                </select>
            </div>
            <div class="input-group">
                <label for="onu-ports">ONU Ports</label>
                <select id="onu-ports">
                    <option value="1">1-Port</option>
                    <option value="4">4-Ports</option>
                </select>
            </div>
        </div>

        <div class="input-grid" style="margin-top: 8px;">
            <div class="input-group">
                <label for="slot">Slot</label>
                <input type="number" id="slot" value="0" min="0" max="16">
            </div>
            <div class="input-group">
                <label for="pon">PON Port</label>
                <input type="number" id="pon" placeholder="PON PORT" min="1" max="16">
            </div>
            <div class="input-group">
                <label for="onu-id">ONU ID</label>
                <input type="number" id="onu-id" placeholder="ONU ID" min="1" max="128">
            </div>
        </div>

        <div class="input-grid two-col" style="margin-top: 8px;">
            <div class="input-group">
                <label for="onu-mac">ONU MAC Address</label>
                <input type="text" id="onu-mac" placeholder="ONU MAC (e.g., AABBCCDDEEFF)">
            </div>
            <div class="input-group">
                <label for="line-profile">Line Profile ID</label>
                <input type="number" id="line-profile" placeholder="LP-ID" value="5" min="1" max="64">
            </div>
        </div>

        <div class="input-grid two-col" style="margin-top: 8px;">
            <div class="input-group">
                <label for="gem-id">GEM ID (C-Data)</label>
                <input type="number" id="gem-id" value="1" min="1" max="4096">
            </div>
            <div class="input-group">
                <label for="bandwidth">Bandwidth Rate (Mbps)</label>
                <select id="bandwidth">
                    <option value="60">60/60</option>
                    <option value="100" selected>100/100</option>
                    <option value="160">160/160</option>
                    <option value="210">210/210</option>
                </select>
            </div>
        </div>

        <div class="input-group full-width" style="margin-top: 8px;">
            <label>VLAN IDs</label>
            <div class="input-grid vlan-grid">
                <input type="text" id="vlan1" placeholder="VLAN 1" value="12">
                <input type="text" id="vlan2" placeholder="VLAN 2">
                <input type="text" id="vlan3" placeholder="VLAN 3">
                <input type="text" id="vlan4" placeholder="VLAN 4">
            </div>
        </div>

        <div class="button-group">
            <button id="generate-btn" onclick="generateScript()">
                <span class="material-icons" style="vertical-align: middle; margin-right: 5px;">play_arrow</span>
                GENERATE
            </button>
            <button id="clear-btn" onclick="clearForm()">
                <span class="material-icons" style="vertical-align: middle; margin-right: 5px;">clear</span>
                CLEAR
            </button>
        </div>
    </div>

    <div class="panel output-panel" id="output-panel">
        <div class="panel-header">
            <span class="material-icons">code</span> Generated Script
        </div>
        <pre id="output-script"></pre>
        <div class="output-buttons">
            <button id="copy-btn" onclick="copyToClipboard()">
                <span class="material-icons" style="vertical-align: middle; margin-right: 5px;">content_copy</span>
                COPY
            </button>
        </div>
    </div>
</div>

<script>
    let darkMode = localStorage.getItem('darkMode') === 'enabled';
    if (darkMode) {
        document.body.classList.add('dark-mode');
    }

    function toggleDarkMode() {
        document.body.classList.toggle('dark-mode');
        darkMode = !darkMode;
        localStorage.setItem('darkMode', darkMode ? 'enabled' : 'disabled');
    }

    function generateScript() {
        const oltType = document.getElementById('olt-type').value;
        const slot = document.getElementById('slot').value;
        const pon = document.getElementById('pon').value;
        const onuId = document.getElementById('onu-id').value;
        const onuPorts = parseInt(document.getElementById('onu-ports').value, 10);
        const onuMac = document.getElementById('onu-mac').value;
        const lineProfile = document.getElementById('line-profile').value;
        const bandwidth = parseInt(document.getElementById('bandwidth').value, 10);
        const gemId = document.getElementById('gem-id').value || '1';
        let vlanList = [
            document.getElementById('vlan1').value.trim(),
            document.getElementById('vlan2').value.trim(),
            document.getElementById('vlan3').value.trim(),
            document.getElementById('vlan4').value.trim()
        ];

        let script = '';
        let srvProfileId = '';

        if (oltType.startsWith('cdata-gpon')) {
            srvProfileId = onuPorts === 4 ? '1' : '4';
        }

        switch (oltType) {
            case 'vsol-gpon':
                const onuMacCleaned = onuMac.replace(/[^a-zA-Z0-9]/g, '');
                script += `onu add ${onuId} profile ${onuPorts}_port_onu sn ${onuMacCleaned}\n`;
                script += `onu ${onuId} profile line id ${lineProfile}\n`;
                
                // First loop to disable/enable ports and set VLANs
                for (let i = 1; i <= onuPorts; i++) {
                    const vlan = vlanList[(i - 1)];
                    if (vlan) {
                        script += `onu ${onuId} eth ${i} state enable\n`;
                        script += `onu ${onuId} portvlan eth ${i} mode tag vlan ${vlan} pri 0\n`;
                        script += `onu ${onuId} eth ${i} loopdetect disable\n`;
                    } else {
                        script += `onu ${onuId} eth ${i} state disable\n`;
                    }
                }
                
                // Second loop to set bandwidth limits for active ports
                for (let i = 1; i <= onuPorts; i++) {
                    const vlan = vlanList[(i - 1)];
                    if (vlan) {
                        const bandwidthKbps = bandwidth * 1024;
                        script += `onu ${onuId} eth ${i} upstream-rate-limit cir ${bandwidthKbps} pir ${bandwidthKbps}\n`;
                        script += `onu ${onuId} eth ${i} downstream-rate-limit cir ${bandwidthKbps} pir ${bandwidthKbps}\n`;
                    }
                }
                script += `exit\n`;
                break;

            case 'cdata-gpon-16':
                script += `ont add ${pon} ${onuId} sn-auth ${onuMac} ont-lineprofile-id ${lineProfile} ont-srvprofile-id ${srvProfileId}\n`;

                if (onuPorts === 1) {
                    const vlan = vlanList[(0)];
                    if (vlan) {
                        script += `ont port native-vlan ${pon} ${onuId} eth 1 vlan ${vlan}\n`;
                        script += `ont port car ${pon} ${onuId} eth 1 inbound ${bandwidth} outbound ${bandwidth}\n`;
                        script += `exit\n`;
                        script += `service-port autoindex vlan ${vlan} gpon 0/0 port ${pon} ont ${onuId} gemport ${gemId} multi-service user-vlan ${vlan} tag-action transparent\n`;
                    }
                } else if (onuPorts === 4) {
                    for (let i = 1; i <= 4; i++) {
                        const vlan = vlanList[(i - 1)];
                        if (vlan) {
                            script += `ont port native-vlan ${pon} ${onuId} eth ${i} vlan ${vlan}\n`;
                            script += `ont port attribute ${pon} ${onuId} eth ${i} operational-state on\n`;
                        } else {
                            script += `ont port attribute ${pon} ${onuId} eth ${i} operational-state off\n`;
                        }
                    }

                    for (let i = 1; i <= 4; i++) {
                        const vlan = vlanList[(i - 1)];
                        if (vlan) {
                            script += `ont port car ${pon} ${onuId} eth ${i} inbound ${bandwidth} outbound ${bandwidth}\n`;
                        }
                    }
                    script += `exit\n`;
                    vlanList.forEach((vlan, index) => {
                        if (vlan) {
                            script += `service-port autoindex vlan ${vlan} gpon 0/0 port ${pon} ont ${onuId} gemport ${gemId} multi-service user-vlan ${vlan} tag-action transparent\n`;
                        }
                    });
                }
                break;
            case 'cdata-gpon-8':
                script += `ont add ${pon} ${onuId} sn-auth ${onuMac} ont-lineprofile-id ${lineProfile} ont-srvprofile-id ${srvProfileId}\n`;
                
                for (let i = 1; i <= onuPorts; i++) {
                    const vlan = vlanList[(i - 1)];
                    if (vlan) {
                        script += `ont port native-vlan ${pon} ${onuId} eth ${i} vlan ${vlan}\n`;
                        script += `ont port attribute ${pon} ${onuId} eth ${i} operational-state on\n`;
                    } else {
                        script += `ont port attribute ${pon} ${onuId} eth ${i} operational-state off\n`;
                    }
                }
                
                for (let i = 1; i <= onuPorts; i++) {
                    const vlan = vlanList[(i - 1)];
                    if (vlan) {
                        script += `ont port car ${pon} ${onuId} eth ${i} inbound ${bandwidth} outbound ${bandwidth}\n`;
                    }
                }
                script += `exit\n`;
                break;
            case 'utstarcom':
                const macFormatted = onuMac.length === 12 ? `${onuMac.substring(0,4)}-${onuMac.substring(4,12)}` : onuMac;
                script += `interface epon-olt ${slot}/${pon}\n`;
                script += `onu ${onuId}\n`;
                script += `dba-sla mac ${macFormatted}\n`;
                script += `dba-sla mac-limit 10\n`;
                for (let i = 1; i <= onuPorts; i++) {
                    if (vlanList[(i - 1)]) {
                        script += `remote-mgmt eth ${i} admin enable\n`;
                        script += `remote-mgmt eth ${i} vlan-mode tag ${vlanList[(i - 1)]} 8100\n`;
                        script += `policing upstream pir-mark-no-drop\n`;
                        script += `policing downstream pir-mark-no-drop\n`;
                        script += `shaping conform-to-pir\n`;
                        script += `dba-sla upstream maximum-bandwidth ${bandwidth * 1024} Kbps\n`;
                        script += `dba-sla upstream max-burst 512 Kbps\n`;
                        script += `dba-sla downstream maximum-bandwidth ${bandwidth * 1024} Kbps\n`;
                        script += `dba-sla downstream max-burst 512 Kbps\n`;
                    } else {
                        script += `remote-mgmt eth ${i} admin disable\n`;
                    }
                }
                script += `exit\nexit\nexit\nconfigure management\nsave\n`;
                break;
            case 'fh-net':
                script += `onu ${slot}/${pon}/${onuId}\n`;
                for (let i = 1; i <= onuPorts; i++) {
                    script += `interface ethernet 0/${i}\n`;
                    if (vlanList[(i - 1)]) {
                        script += `no onu-shutdown\n`;
                        script += `onu-vlan-mode tag vlan ${vlanList[(i - 1)]}\n`;
                    } else {
                        script += `onu-shutdown\n`;
                    }
                    script += `exit\n`;
                }
                script += `onu-bandwidth upstream fir 0 cir 0 pir ${bandwidth * 1024}\n`;
                script += `onu-bandwidth downstream fir 0 cir 0 pir ${bandwidth * 1024}\n`;
                script += `onu-bandwidth shaper pir\n`;
                script += `exit\nexit\ncopy running-config startup-config\ny\n`;
                break;
            case 'phyhome':
                script += `service\nconfigure\n`;
                for (let i = 1; i <= onuPorts; i++) {
                    const vlan = vlanList[(i - 1)];
                    if (vlan) {
                        script += `service number ${slot} ${pon} ${onuId} 1 ${i}\n`;
                        script += `customer-vlan ${slot} ${pon} ${onuId} 1 ${i} tag 7 33024 ${vlan}\n`;
                        script += `apply fe-service-compress-pkt ${slot} ${pon} ${onuId}\n`;
                    }
                    script += `onu-port-attribute ${slot} ${pon} ${onuId} ${i} ${vlan ? 'enable' : 'disable'}\n`;
                }
                for (let i = 1; i <= onuPorts; i++) {
                    const vlan = vlanList[(i - 1)];
                    if (vlan) {
                        script += `port-policing-config ${slot} ${pon} ${onuId} ${i} up-state enable up-parameters 99328 16384 1024 down-state enable down-parameters 99328 99328\n`;
                        script += `exit\nsystem\nconfigure\n`;
                        script += `max-mac-counter ${slot} ${pon} ${onuId} ${i} 10\n`;
                    }
                }
                script += `exit\nexit\nsave\n`;
                break;
        }

        document.getElementById('output-script').innerText = script;
    }

    function clearForm() {
        document.getElementById('olt-type').value = 'cdata-gpon-16';
        document.getElementById('onu-ports').value = '1';
        document.getElementById('slot').value = '0';
        document.getElementById('pon').value = '';
        document.getElementById('onu-id').value = '';
        document.getElementById('onu-mac').value = '';
        document.getElementById('line-profile').value = '5';
        document.getElementById('gem-id').value = '1';
        document.getElementById('bandwidth').value = '100';
        document.getElementById('vlan1').value = '';
        document.getElementById('vlan2').value = '';
        document.getElementById('vlan3').value = '';
        document.getElementById('vlan4').value = '';
        document.getElementById('output-script').innerText = '';
    }

    function copyToClipboard() {
        const outputText = document.getElementById('output-script').innerText;
        if (!outputText.trim()) {
            alert('No script to copy! Please generate a script first.');
            return;
        }
        
        navigator.clipboard.writeText(outputText).then(() => {
            const copyBtn = document.getElementById('copy-btn');
            const originalText = copyBtn.innerHTML;
            copyBtn.innerHTML = '<span class="material-icons" style="vertical-align: middle; margin-right: 5px;">check</span> COPIED!';
            copyBtn.style.background = 'linear-gradient(135deg, #ba68c8 0%, #9c27b0 100%)';
            
            setTimeout(() => {
                copyBtn.innerHTML = originalText;
                copyBtn.style.background = 'linear-gradient(135deg, #673ab7 0%, #5e35b1 100%)';
            }, 2000);
        }).catch(err => {
            console.error('Failed to copy text: ', err);
            alert('Failed to copy script to clipboard.');
        });
    }

    document.addEventListener('DOMContentLoaded', () => {
        // Set default values after the page loads
        document.getElementById('olt-type').value = 'cdata-gpon-16';
        document.getElementById('onu-ports').value = '1';
        document.getElementById('slot').value = '0';
        document.getElementById('pon').value = '';
        document.getElementById('onu-id').value = '';
        document.getElementById('onu-mac').value = '';
        document.getElementById('line-profile').value = '5';
        document.getElementById('gem-id').value = '1';
        document.getElementById('bandwidth').value = '100';
        document.getElementById('vlan1').value = '';
        document.getElementById('vlan2').value = '';
        document.getElementById('vlan3').value = '';
        document.getElementById('vlan4').value = '';
        
        // Generate initial script
        setTimeout(generateScript, 300);
        
        // Add input validation
        const numberInputs = document.querySelectorAll('input[type="number"]');
        numberInputs.forEach(input => {
            input.addEventListener('input', () => {
                if (input.value < 0) input.value = 0;
            });
        });
        
        // Auto-format MAC address
        const macInput = document.getElementById('onu-mac');
        macInput.addEventListener('input', (e) => {
            let value = e.target.value.replace(/[^a-fA-F0-9]/g, '').toUpperCase();
            if (value.length > 12) value = value.substring(0, 12);
            e.target.value = value;
        });
    });
</script>

</body>
</html>
